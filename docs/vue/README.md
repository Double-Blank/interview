## vue

### ç”Ÿå‘½å‘¨æœŸ

```text
beforeCreate ç»„ä»¶å®ä¾‹è¢«åˆ›å»ºä¹‹åˆï¼Œdata å’Œ methods ä¸­çš„æ•°æ®è¿˜æ²¡æœ‰åˆå§‹åŒ–
created æ•´ä¸ªVueå®ä¾‹åˆ›å»ºå®Œæ¯•ï¼Œç»„ä»¶å®ä¾‹å·²ç»å®Œå…¨åˆ›å»ºï¼Œdata å’Œ methods éƒ½å·²ç»åˆå§‹åŒ–å¥½äº†
bebeforeMount æ¨¡æ¿æ¸²æŸ“ï¼Œç›¸å…³çš„ render å‡½æ•°é¦–æ¬¡è¢«è°ƒç”¨ï¼Œæ¨¡æ¿å·²ç»åœ¨å†…å­˜ä¸­ç¼–è¯‘å¥½äº†ï¼Œä½†æ˜¯å°šæœªæŒ‚è½½åˆ°é¡µé¢ä¸­å»
mounted ç»„ä»¶å†…å®¹æ¸²æŸ“åˆ°é¡µé¢ï¼Œel è¢«æ–°åˆ›å»ºçš„ vm.el æ›¿æ¢ï¼ŒçœŸå®domå·²ç»ç”Ÿæˆï¼Œelå¯ç”¨ï¼Œç»„ä»¶è„±ç¦»åˆ›å»ºé˜¶æ®µï¼Œè¿›å…¥è¿è¡Œé˜¶æ®µ
beforeUpdate åœ¨æ•°æ®å‘ç”Ÿæ”¹å˜åï¼ŒDOM è¢«æ›´æ–°ä¹‹å‰è¢«è°ƒç”¨ã€‚
updated åœ¨æ•°æ®æ›´æ”¹å¯¼è‡´çš„è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ›´æ–°å®Œæ¯•ä¹‹åè¢«è°ƒç”¨ã€‚
  activated è¢« keep-alive ç¼“å­˜çš„ç»„ä»¶æ¿€æ´»æ—¶è°ƒç”¨ã€‚
  deactivated è¢« keep-alive ç¼“å­˜çš„ç»„ä»¶å¤±æ´»æ—¶è°ƒç”¨ã€‚
beforeDestroy å®ä¾‹é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚åœ¨è¿™ä¸€æ­¥ï¼Œå®ä¾‹ä»ç„¶å®Œå…¨å¯ç”¨ã€‚
destroyed å®ä¾‹é”€æ¯åè°ƒç”¨ã€‚

åˆ›å»ºå®ä¾‹æ˜¯ä»çˆ¶åˆ°å­ï¼Œæ¸²æŸ“ä»å­åˆ°çˆ¶

çˆ¶beforeCreate â€”> çˆ¶created â€”> çˆ¶beforeMount â€”> å­beforeCreate â€”> å­created â€”> å­beforeMount â€”> å­mounted â€”> çˆ¶mounted

çˆ¶beforeUpdate â€”> å­beforeUpdate â€”> å­updated â€”> çˆ¶updated

çˆ¶beforeDestroy -> å­beforeDestroy -> å­destroyed-> çˆ¶destroyed

beforeDestory é’©å­èƒ½åšä»€ä¹ˆ
æˆ‘ä»¬å¸¸ç”¨æ¥é”€æ¯ä¸€äº›ç›‘å¬äº‹ä»¶åŠå®šæ—¶å‡½æ•°ï¼Œä½¿ç”¨åœºæ™¯ä¸€èˆ¬ç”¨åœ¨vueå®ä¾‹çš„$offæ–¹æ³•æ¸…é™¤eventBus
```

### ç”Ÿå‘½å‘¨æœŸé’©å­æ˜¯å¦‚ä½•å®ç°çš„

Vue çš„ç”Ÿå‘½å‘¨æœŸé’©å­æ ¸å¿ƒå®ç°æ˜¯åˆ©ç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼å…ˆæŠŠç”¨æˆ·ä¼ å…¥çš„ç”Ÿå‘½å‘¨æœŸé’©å­è®¢é˜…å¥½ï¼ˆå†…éƒ¨é‡‡ç”¨æ•°ç»„çš„æ–¹æ³•å­˜å‚¨ï¼‰ç„¶ååœ¨åˆ›å»ºç»„ä»¶å®ä¾‹çš„è¿‡ç¨‹ä¸­ä¼šä¸€æ¬¡æ‰§è¡Œå¯¹åº”çš„é’©å­æ–¹æ³•ï¼ˆå‘å¸ƒï¼‰

### Vueç»„ä»¶é€šä¿¡ ğŸ”¥

- props $emit
  - çˆ¶ -> å­ props
  - å­ -> çˆ¶ this.$emit() 

- $parent å’Œ $children

  - å½“ä¸€ä¸ªç»„ä»¶éœ€è¦è®¿é—®å…¶çˆ¶ç»„ä»¶æˆ–å­ç»„ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `$parent` æˆ– `$children` å±æ€§

- è‡ªå®šä¹‰äº‹ä»¶

  ```js
  eventBus  
  
  // main.js 
  export const eventBus = new Vue()
  //æˆ–
  Vue.prototype.$eventBus = new Vue()
  
  // child1  
  hub.$emit
  
  // child2 
  created -> hub.$on //ç›‘å¬äº‹ä»¶ï¼Œå¦‚æœäº‹ä»¶è¢«è§¦å‘ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°
  //å…·ä½“ä¸ºï¼š
  created() {eventBus.on('methodæ–¹æ³•å', () => {})}
  
  // è®°å¾— ç§»é™¤ EventBus.$off
  ```

- Vuex

  ```
  child1 this.$store.commit()
  child2 ...mapState(['username])
  ```

### props å’Œ data è°ä¼˜å…ˆçº§é«˜

props é«˜

props ==> methods ==> data ==> computed ==> watch

### dataå¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°

ä¸æƒ³æ¯ä¸ªç»„ä»¶å…±äº«åŒä¸€ä»½æ•°æ®ï¼Œå‡½æ•°å°±å¯ä»¥è®©æˆ‘ä»¬å•ç‹¬çš„ç»´æŠ¤ä¸€ä¸ªæ•°æ®

### VuexåŸºæœ¬ä½¿ç”¨

state: æ•°æ®

getters: stateçš„è®¡ç®—å±æ€§ è¾…åŠ©å‡½æ•°: mapGetters å®šä¹‰åœ¨Computed é‡Œä½¿ç”¨ <=> $store.state.items

mutaion: è®¾ç½®æ•°æ® è¾…åŠ©å‡½æ•°: mapMutations <=> this.$store.commit å®šä¹‰åœ¨methods é‡Œ

action: æ˜¯å¼‚æ­¥æ“ä½œæ–¹æ³• å¯ä»¥æ‹¿åˆ°å‚æ•°commit,stateå»æ‰§è¡Œmutaiton è¾…åŠ©å‡½æ•°: mapActions <=> this.$store.dispatch()

### ä¸€å®šä¸è¦åœ¨actionä¸­ä¿®æ”¹stateï¼Œè€Œæ˜¯è¦åœ¨mutationä¸­ä¿®æ”¹

å› ä¸ºstateæ˜¯å®æ—¶æ›´æ–°çš„ï¼Œmutationsæ— æ³•è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œè€Œå¦‚æœç›´æ¥ä¿®æ”¹stateçš„è¯æ˜¯èƒ½å¤Ÿå¼‚æ­¥æ“ä½œçš„ï¼Œå½“ä½ å¼‚æ­¥å¯¹stateè¿›è¡Œæ“ä½œæ—¶ï¼Œè¿˜æ²¡æ‰§è¡Œå®Œï¼Œè¿™æ—¶å€™å¦‚æœstateå·²ç»åœ¨å…¶ä»–åœ°æ–¹è¢«ä¿®æ”¹äº†ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ç¨‹åºå­˜åœ¨é—®é¢˜äº†ã€‚æ‰€ä»¥stateè¦åŒæ­¥æ“ä½œï¼Œé€šè¿‡mutationsçš„æ–¹å¼é™åˆ¶äº†ä¸å…è®¸å¼‚æ­¥ã€‚

### actions å’Œ mutaions çš„åŒºåˆ«

actions å¯ä»¥è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œå¯ç”¨äºå‘åå°æäº¤æ•°æ®æˆ–è€…æ¥å—åå°çš„æ•°æ®ï¼›

mutations ä¸­æ˜¯åŒæ­¥æ“ä½œï¼Œç”¨äºå°†æ•°æ®ä¿¡æ¯å†™åœ¨å…¨å±€æ•°æ®çŠ¶æ€ä¸­ç¼“å­˜ã€‚

### Vuexå¦‚ä½•ä¿è¯æ¯ä¸ªç»„ä»¶éƒ½æ‹¿åˆ°åŒä¸€ä¸ªstoreå®ä¾‹çš„ ğŸˆ

  Vuex æä¾›äº†ä¸€ä¸ª store é€‰é¡¹ï¼Œç”¨äºåœ¨æ ¹ç»„ä»¶ä¸­åˆ›å»ºä¸€ä¸ª Vuex store å®ä¾‹ï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ°æ‰€æœ‰å­ç»„ä»¶ä¸­ã€‚

```
Vue.use(Vuex) -> æ’ä»¶çš„installæ–¹æ³•
applyMixin(Vue)
åˆ¤æ–­æ˜¯ä¸æ˜¯æ ¹ï¼Œå¦‚æœæ˜¯æ ¹å°±æ·»åŠ ä¸€ä¸ªstoreå±æ€§ -ã€‹ newVue å°±èƒ½è·å–Vue store
 ä¸æ˜¯æ ¹å°±å»çˆ¶äº²ä¸Šæ‹¿ï¼Œèµ‹å€¼åˆ°è‡ªå·±çš„$storeå±æ€§
```

Vuexæ˜¯é€šè¿‡å…¨å±€æ³¨å…¥storeå¯¹è±¡ï¼Œåˆ©ç”¨vueçš„mixinæ··å…¥æœºåˆ¶ï¼Œåœ¨beforeCreateé’©å­å‰æ··å…¥vuexInitæ–¹æ³•ï¼ŒvuexInitæ–¹æ³•å®ç°äº†storeæ³¨å…¥

![img](http://qn.aixshi.top/blog/vuex.png)

### Vuex ä¸ºä»€ä¹ˆè¦åˆ†æ¨¡å—å¹¶ä¸”åŠ å‘½åç©ºé—´

æ¨¡å—ï¼š ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½ä¼šå˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆæ¨¡å—ï¼ˆmoduleï¼‰ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getterã€ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—ã€‚

å‘½åç©ºé—´ï¼š é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…éƒ¨çš„ actionã€mutationã€getteræ˜¯æ³¨å†Œåœ¨å…¨å±€å‘½åç©ºé—´çš„ --- è¿™æ ·ä½¿å¾—å¤šä¸ªæ¨¡å—èƒ½å¤Ÿå¯¹åŒä¸€ mutation æˆ– action åšå‡ºå“åº”ã€‚å¦‚æœå¸Œæœ›ä½ çš„æ¨¡å—å…·æœ‰æ›´é«˜çš„å°è£…åº¦å’Œå¤ç”¨æ€§ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ  namespaced:true çš„æ–¹å¼ä½¿å…¶æˆä¸ºå¸¦å‘½åçš„æ¨¡å—ã€‚å½“æ¨¡å—è¢«æ³¨å†Œåï¼Œä»–æ‰€æœ‰ getterã€actionã€åŠ mutation éƒ½ä¼šè‡ªåŠ¨æ ¹æ®æ¨¡å—æ³¨å†Œçš„è·¯å¾„è°ƒæ•´å‘½åã€‚

### vueä¸­mixinçš„åŸç†

mixin -> å°è£…ï¼Œå¯å¤ç”¨ï¼Œmixinçš„ç”Ÿå‘½å‘¨æœŸæ¯”å…¶ä»–çš„å…ˆæ‰§è¡Œ

ä¸»è¦æ˜¯è°ƒç”¨`merOptions`æ–¹æ³•

é€’å½’å¤„ç† mixins å…ˆéå†åˆå¹¶parentä¸­çš„keyï¼Œè°ƒç”¨mergeFieldæ–¹æ³•è¿›è¡Œåˆå¹¶ï¼Œ

ç„¶åä¿å­˜åœ¨å˜é‡options

å†éå†childï¼Œåˆå¹¶è¡¥ä¸Šparentä¸­æ²¡æœ‰çš„keyï¼Œè°ƒç”¨mergeFieldæ–¹æ³•è¿›è¡Œåˆå¹¶ï¼Œä¿å­˜åœ¨å˜é‡options

é€šè¿‡ mergeField å‡½æ•°è¿›è¡Œäº†åˆå¹¶ åˆå¹¶ç­–ç•¥ï¼šæ›¿æ¢å‹ã€åˆå¹¶å‹ã€é˜Ÿåˆ—å‹ã€å åŠ å‹

### vue å†…ç½®æŒ‡ä»¤

```
v-once - å®šä¹‰å®ƒçš„å…ƒç´ æˆ–ç»„ä»¶åªæ¸²æŸ“ä¸€æ¬¡ï¼ŒåŒ…æ‹¬å…ƒç´ æˆ–ç»„ä»¶çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œé¦–æ¬¡æ¸²æŸ“åï¼Œä¸å†éšæ•°æ®çš„å˜åŒ–é‡æ–°æ¸²æŸ“ï¼Œå°†è¢«è§†ä¸ºé™æ€å†…å®¹ã€‚
v-cloak - è¿™ä¸ªæŒ‡ä»¤ä¿æŒåœ¨å…ƒç´ ä¸Šç›´åˆ°å…³è”å®ä¾‹ç»“æŸç¼–è¯‘ -- è§£å†³åˆå§‹åŒ–æ…¢åˆ°é¡µé¢é—ªåŠ¨çš„æœ€ä½³å®è·µã€‚
v-bind - ç»‘å®šå±æ€§ï¼ŒåŠ¨æ€æ›´æ–°HTMLå…ƒç´ ä¸Šçš„å±æ€§ã€‚ä¾‹å¦‚ v-bind:classã€‚
v-on - ç”¨äºç›‘å¬DOMäº‹ä»¶ã€‚ä¾‹å¦‚ v-on:click v-on:keyup
v-html - èµ‹å€¼å°±æ˜¯å˜é‡çš„innerHTML -- æ³¨æ„é˜²æ­¢xssæ”»å‡»
v-text - æ›´æ–°å…ƒç´ çš„textContent
v-model - 1ã€åœ¨æ™®é€šæ ‡ç­¾ã€‚å˜æˆvalueå’Œinputçš„è¯­æ³•ç³–ï¼Œå¹¶ä¸”ä¼šå¤„ç†æ‹¼éŸ³è¾“å…¥æ³•çš„é—®é¢˜ã€‚2ã€å†ç»„ä»¶ä¸Šã€‚ä¹Ÿæ˜¯å¤„ç†valueå’Œinputè¯­æ³•ç³–ã€‚
v-if / v-else / v-else-ifã€‚å¯ä»¥é…åˆtemplateä½¿ç”¨ï¼›åœ¨renderå‡½æ•°é‡Œé¢å°±æ˜¯ä¸‰å…ƒè¡¨è¾¾å¼ã€‚
v-show - ä½¿ç”¨æŒ‡ä»¤æ¥å®ç° -- æœ€ç»ˆä¼šé€šè¿‡displayæ¥è¿›è¡Œæ˜¾ç¤ºéšè—
v-for - å¾ªç¯æŒ‡ä»¤ç¼–è¯‘å‡ºæ¥çš„ç»“æœæ˜¯ -L ä»£è¡¨æ¸²æŸ“åˆ—è¡¨ã€‚ä¼˜å…ˆçº§æ¯”v-ifé«˜æœ€å¥½ä¸è¦ä¸€èµ·ä½¿ç”¨ï¼Œå°½é‡ä½¿ç”¨è®¡ç®—å±æ€§å»è§£å†³ã€‚æ³¨æ„å¢åŠ å”¯ä¸€keyå€¼ï¼Œä¸è¦ä½¿ç”¨indexä½œä¸ºkeyã€‚
v-pre - è·³è¿‡è¿™ä¸ªå…ƒç´ ä»¥åŠå­å…ƒç´ çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œä»¥æ­¤æ¥åŠ å¿«æ•´ä¸ªé¡¹ç›®çš„ç¼–è¯‘é€Ÿåº¦ã€‚
```

### ä¸ºä»€ä¹ˆthis.xxxèƒ½è®¿é—®dataé‡Œé¢çš„æ•°æ®

```text
Vue.js åœ¨ç»„ä»¶å®ä¾‹åŒ–æ—¶ï¼Œä¼šå°†è¿™äº›å±æ€§åˆå¹¶åˆ°ç»„ä»¶å®ä¾‹ä¸­ï¼Œå¹¶å°†å®ƒä»¬ä»£ç†åˆ°ç»„ä»¶å®ä¾‹çš„å±æ€§ä¸­
this._init(options)
initState -> initData
this.msg Vueä¼šåšä»£ç†
è®¿é—® this._data.msg
```

### å¦‚ä½•ç†è§£MVVMï¼ˆåŒå‘ç»‘å®šï¼‰

>Viewå’ŒModelä¹‹é—´æ˜¯æ²¡æœ‰ç›´æ¥è”ç³»çš„ï¼Œå®ƒä»¬é€šè¿‡ViewModelè¿›è¡Œé€šä¿¡ã€‚ViewModelè´Ÿè´£å¤„ç†Viewçš„äº‹ä»¶ï¼Œæ›´æ–°Modelçš„æ•°æ®ï¼Œå¹¶å°†æ•°æ®ç»‘å®šåˆ°Viewä¸­ï¼Œä½¿å¾—æ•°æ®åœ¨Viewä¸­çš„å±•ç¤ºå’Œç”¨æˆ·çš„æ“ä½œéƒ½èƒ½å¤Ÿè‡ªåŠ¨åŒæ­¥åˆ°Modelä¸­

### å®ç°åŒå‘ç»‘å®š

æˆ‘ä»¬è¿˜æ˜¯ä»¥ Vue ä¸ºä¾‹ï¼Œå…ˆæ¥çœ‹çœ‹ Vue ä¸­çš„åŒå‘ç»‘å®šæµç¨‹æ˜¯ä»€ä¹ˆçš„

- new Vue()é¦–å…ˆæ‰§è¡Œåˆå§‹åŒ–ï¼Œå¯¹ data æ‰§è¡Œå“åº”åŒ–å¤„ç†ï¼Œè¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿ Observe ä¸­ï¼›defineReactive æ—¶ä¸ºæ¯â¼€ä¸ª key åˆ›å»ºâ¼€ä¸ª Dep å®ä¾‹
- åŒæ—¶å¯¹æ¨¡æ¿æ‰§è¡Œç¼–è¯‘ï¼Œæ‰¾åˆ°å…¶ä¸­åŠ¨æ€ç»‘å®šçš„æ•°æ®ï¼Œä» data ä¸­è·å–å¹¶åˆå§‹åŒ–è§†å›¾ï¼Œè¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿåœ¨ Compile ä¸­ï¼›åˆå§‹åŒ–è§†å›¾æ—¶è¯»å–æŸä¸ª keyï¼Œä¾‹å¦‚ name1ï¼Œåˆ›å»ºâ¼€ä¸ª watcher1
- åŒæ—¶å®šä¹‰â¼€ä¸ªæ›´æ–°å‡½æ•°å’Œ Watcherï¼Œå°†æ¥å¯¹åº”æ•°æ®å˜åŒ–æ—¶ Watcher ä¼šè°ƒç”¨æ›´æ–°å‡½æ•°
- ç”±äº data çš„æŸä¸ª key åœ¨â¼€ä¸ªè§†å›¾ä¸­å¯èƒ½å‡ºç°å¤šæ¬¡ï¼Œæ‰€ä»¥æ¯ä¸ª key éƒ½éœ€è¦â¼€ä¸ªç®¡å®¶ Dep æ¥ç®¡ç†å¤šä¸ª Watcher;ç”±äºè§¦å‘ name1 çš„ getter æ–¹æ³•ï¼Œä¾¿å°† watcher1 æ·»åŠ åˆ° name1 å¯¹åº”çš„ Dep ä¸­
- å°†æ¥ data ä¸­æ•°æ®â¼€æ—¦å‘ç”Ÿå˜åŒ–,ä¼šé¦–å…ˆæ‰¾åˆ°å¯¹åº”çš„ Depï¼Œé€šçŸ¥æ‰€æœ‰ Watcher æ‰§è¡Œæ›´æ–°å‡½æ•°ï¼›å½“ name1 æ›´æ–°ï¼Œsetter è§¦å‘æ—¶ï¼Œä¾¿å¯é€šè¿‡å¯¹åº” Dep é€šçŸ¥å…¶ç®¡ç†æ‰€æœ‰ Watcher æ›´æ–°

[imgåœ°å€(opens new window)](https://img.bosszhipin.com/beijin/cms/6c155f92bf101d7f3474c8db1dc5a5f2ceb4162adcce9c8ed358cb008b64ac2a92d08620afbe4bc5b07a8d61e4550181.png?x-oss-process=image/quality,q_60)

å®ç°æ€è·¯

- defineReactive æ—¶ä¸ºæ¯â¼€ä¸ª key åˆ›å»ºâ¼€ä¸ª Dep å®ä¾‹
- åˆå§‹åŒ–è§†å›¾æ—¶è¯»å–æŸä¸ª keyï¼Œä¾‹å¦‚ name1ï¼Œåˆ›å»ºâ¼€ä¸ª watcher1
- ç”±äºè§¦å‘ name1 çš„ getter æ–¹æ³•ï¼Œä¾¿å°† watcher1 æ·»åŠ åˆ° name1 å¯¹åº”çš„ Dep ä¸­
- å½“ name1 æ›´æ–°ï¼Œsetter è§¦å‘æ—¶ï¼Œä¾¿å¯é€šè¿‡å¯¹åº” Dep é€šçŸ¥å…¶ç®¡ç†æ‰€æœ‰ Watcher æ›´æ–°

### Vue çš„å®ç°åŸç†

Vue2 çš„å®ç°åŸç†ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1. æ•°æ®åŠ«æŒï¼šVue2 ä½¿ç”¨äº† Object.defineProperty æ–¹æ³•æ¥å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒï¼Œä»è€Œå®ç°äº†å“åº”å¼æ•°æ®ç»‘å®šã€‚Vue2 ä¼šåœ¨åˆå§‹åŒ–æ—¶é€’å½’åœ°éå† data å¯¹è±¡çš„æ¯ä¸ªå±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.defineProperty æ–¹æ³•å°†å…¶è½¬æ¢ä¸º getter å’Œ setterï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè§¦å‘ setter æ–¹æ³•ï¼Œä»è€Œé€šçŸ¥ä¾èµ–äºè¯¥æ•°æ®çš„ç»„ä»¶è¿›è¡Œæ›´æ–°ã€‚
2. æ¨¡æ¿ç¼–è¯‘ï¼šVue2 ä½¿ç”¨äº†ç¼–è¯‘å™¨å°†æ¨¡æ¿è½¬æ¢æˆæ¸²æŸ“å‡½æ•°ï¼Œä»è€Œå®ç°äº†æ¨¡æ¿çš„åŠ¨æ€æ¸²æŸ“ã€‚Vue2 çš„ç¼–è¯‘å™¨ä¼šå°†æ¨¡æ¿è§£ææˆ ASTï¼Œç„¶åé€šè¿‡ AST è½¬æ¢å™¨å°†å…¶è½¬æ¢æˆæ¸²æŸ“å‡½æ•°ï¼Œæ¸²æŸ“å‡½æ•°æ¥æ”¶æ•°æ®å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œç”Ÿæˆè™šæ‹Ÿ DOM å¹¶æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚
3. è™šæ‹Ÿ DOMï¼šVue2 ä½¿ç”¨äº†è™šæ‹Ÿ DOM æ¥ä¼˜åŒ–è§†å›¾çš„æ¸²æŸ“æ€§èƒ½ã€‚è™šæ‹Ÿ DOM æ˜¯ä¸€ä¸ªæŠ½è±¡çš„ DOM æ ‘ï¼Œå®ƒå¯ä»¥åœ¨å†…å­˜ä¸­è¿›è¡Œæ“ä½œå’Œè®¡ç®—ï¼Œå‡å°‘äº†çœŸå® DOM çš„æ“ä½œå’Œè®¡ç®—æ¬¡æ•°ï¼Œä»è€Œæé«˜äº†æ¸²æŸ“æ€§èƒ½ã€‚Vue2 çš„è™šæ‹Ÿ DOM å’Œ React çš„è™šæ‹Ÿ DOM ç±»ä¼¼ï¼Œéƒ½æ˜¯åŸºäºæ ‘å½¢ç»“æ„çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥è¿›è¡Œå¿«é€Ÿçš„æ¯”è¾ƒå’Œæ›´æ–°ã€‚
4. ç»„ä»¶åŒ–ï¼šVue2 æ”¯æŒç»„ä»¶åŒ–å¼€å‘ï¼Œå¯ä»¥å°†é¡µé¢æ‹†åˆ†æˆå¤šä¸ªç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„æ¨¡æ¿ã€æ ·å¼å’Œé€»è¾‘ã€‚Vue2 çš„ç»„ä»¶åŒ–å¼€å‘å¯ä»¥æé«˜ä»£ç çš„å¤ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºæ›´åŠ æ˜“äºæ‰©å±•å’Œç»´æŠ¤ã€‚
5. ç”Ÿå‘½å‘¨æœŸï¼šVue2 çš„ç»„ä»¶æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œå¯ä»¥åœ¨ç»„ä»¶åˆ›å»ºã€æŒ‚è½½ã€æ›´æ–°å’Œé”€æ¯ç­‰ä¸åŒçš„é˜¶æ®µæ‰§è¡Œä¸€äº›ç‰¹å®šçš„é€»è¾‘ã€‚Vue2 çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°åŒ…æ‹¬ beforeCreateã€createdã€beforeMountã€mountedã€beforeUpdateã€updatedã€beforeDestroy å’Œ destroyed ç­‰ã€‚
6. æŒ‡ä»¤å’Œæ’ä»¶æœºåˆ¶ï¼šVue2 æä¾›äº†ä¸€äº›å†…ç½®æŒ‡ä»¤å’Œæ’ä»¶æœºåˆ¶ï¼Œå¯ä»¥æ‰©å±• Vue çš„åŠŸèƒ½å’Œç‰¹æ€§ã€‚Vue2 çš„æŒ‡ä»¤åŒ…æ‹¬ v-ifã€v-forã€v-bindã€v-on ç­‰ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ“ä½œè§†å›¾å’Œæ•°æ®ä¹‹é—´çš„å…³ç³»ã€‚Vue2 çš„æ’ä»¶æœºåˆ¶å¯ä»¥è®©å¼€å‘è€…ç¼–å†™è‡ªå·±çš„æ’ä»¶ï¼Œä»è€Œæ‰©å±• Vue çš„åŠŸèƒ½å’Œç‰¹æ€§ï¼Œä¾‹å¦‚ Vuexã€Vue Router ç­‰ã€‚

> æ·±åº¦ç›‘å¬éœ€è¦é€’å½’åˆ°åº•ï¼Œä¸€æ¬¡æ€§è®¡ç®—é‡ç‰¹åˆ«å¤§

éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒVue2 çš„å®ç°åŸç†å’Œ Vue3 æœ‰ä¸€äº›ä¸åŒï¼ŒVue3 åœ¨æ•°æ®åŠ«æŒã€æ¨¡æ¿ç¼–è¯‘å’Œè™šæ‹Ÿ DOM ç­‰æ–¹é¢åšå‡ºäº†ä¸€äº›æ”¹è¿›å’Œä¼˜åŒ–ã€‚

>vue åˆæ¬¡æ¸²æŸ“è¿‡ç¨‹
>
>Vue åˆæ¬¡æ¸²æŸ“è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š
>
>1. è§£ææ¨¡æ¿ï¼šVue ä¼šå…ˆè§£ææ¨¡æ¿ï¼Œå°†æ¨¡æ¿ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°ã€‚æ¸²æŸ“å‡½æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶æ•°æ®å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›è™šæ‹Ÿ DOM æ ‘ã€‚
>2. åˆ›å»ºè™šæ‹Ÿ DOM æ ‘ï¼šåœ¨åˆæ¬¡æ¸²æŸ“æ—¶ï¼ŒVue ä¼šå°†æ¸²æŸ“å‡½æ•°çš„è¿”å›å€¼ï¼ˆè™šæ‹Ÿ DOM æ ‘ï¼‰å’ŒçœŸå® DOM æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾å‡ºä¸¤è€…ä¹‹é—´çš„å·®å¼‚ï¼Œç„¶åæ ¹æ®å·®å¼‚è¿›è¡Œå±€éƒ¨æ›´æ–°ã€‚å› æ­¤ï¼ŒVue éœ€è¦å…ˆåˆ›å»ºè™šæ‹Ÿ DOM æ ‘ã€‚
>3. åˆå§‹åŒ– Watcherï¼šåœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼ŒVue ä¼šä¸ºæ¯ä¸ªå“åº”å¼æ•°æ®å¯¹è±¡åˆ›å»ºä¸€ä¸ª Watcher å¯¹è±¡ï¼Œç”¨äºç›‘å¬æ•°æ®å˜åŒ–ï¼Œå¹¶åœ¨å˜åŒ–æ—¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚
>4. æ‰§è¡Œæ¸²æŸ“å‡½æ•°ï¼šåœ¨åˆæ¬¡æ¸²æŸ“æ—¶ï¼ŒVue ä¼šæ‰§è¡Œæ¸²æŸ“å‡½æ•°ï¼Œç”Ÿæˆè™šæ‹Ÿ DOM æ ‘ã€‚
>5. å°†è™šæ‹Ÿ DOM æ ‘è½¬æ¢æˆçœŸå® DOM æ ‘ï¼šåœ¨ç”Ÿæˆè™šæ‹Ÿ DOM æ ‘åï¼ŒVue ä¼šå°†å…¶è½¬æ¢æˆçœŸå® DOM æ ‘ï¼Œå¹¶æ’å…¥åˆ°æ–‡æ¡£ä¸­ã€‚
>6. è¿”å›æŒ‚è½½çš„å®ä¾‹ï¼šVue ä¼šè¿”å›ä¸€ä¸ª Vue å®ä¾‹ï¼Œè¯¥å®ä¾‹å¯ä»¥é€šè¿‡ $el å±æ€§è®¿é—®åˆ°æŒ‚è½½çš„å…ƒç´ ã€‚
>
>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°è¿‡ç¨‹æ˜¯ä¸€ä¸ªåŒæ­¥è¿‡ç¨‹ï¼Œå³åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šæ¶‰åŠå¼‚æ­¥æ“ä½œã€‚å¦‚æœæ¸²æŸ“è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°å¼‚æ­¥æ“ä½œï¼Œä¾‹å¦‚ä½¿ç”¨äº† nextTick æ–¹æ³•æˆ–è€…åœ¨ç»„ä»¶ä¸­ä½¿ç”¨äº†å¼‚æ­¥ç»„ä»¶ï¼Œé‚£ä¹ˆæ¸²æŸ“è¿‡ç¨‹ä¼šç¨æœ‰ä¸åŒ
>
>å¼‚æ­¥æ¸²æŸ“
>
>nextTick å¾… DOM æ¸²æŸ“å®Œå†å›è°ƒ

### ç›‘å¬dataå˜åŒ–çš„æ ¸å¿ƒAPI

#### Vue2

Vue2 ä½¿ç”¨äº† Object.defineProperty æ–¹æ³•æ¥å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒï¼Œä»è€Œå®ç°äº†å“åº”å¼æ•°æ®ç»‘å®šã€‚Vue2 ä¼šåœ¨åˆå§‹åŒ–æ—¶é€’å½’åœ°éå† data å¯¹è±¡çš„æ¯ä¸ªå±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.defineProperty æ–¹æ³•å°†å…¶è½¬æ¢ä¸º getter å’Œ setterï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè§¦å‘ setter æ–¹æ³•ï¼Œä»è€Œé€šçŸ¥ä¾èµ–äºè¯¥æ•°æ®çš„ç»„ä»¶è¿›è¡Œæ›´æ–°ã€‚

```js
// ä¸ç‰ˆ
function observe(data) {
  Object.keys(data).forEach(key => {
    let value = data[key];

    Object.defineProperty(data, key, {
      enumerable: true,
      configurable: true,
      get() {
        console.log(`get ${key}: ${value}`);
        return value;
      },
      set(newValue) {
        console.log(`set ${key}: ${newValue}`);
        if (value !== newValue) {
          value = newValue;
        }
      }
    });
  });
}
const obj = {
  name: 'Vue.js',
  age: 3
};
observe(obj);
console.log(obj.name); // get name: Vue.js
obj.name = 'React.js'; // set name: React.js
```

```js
function updateView() {
  console.log('è§†å›¾æ›´æ–°')
}
// é‡æ–°å®šä¹‰æ•°ç»„åŸå‹
const oldArrayProperty = Array.prototype
const arrProto = Object.create(oldArrayProperty);
['push', 'pop', 'shift', 'unshift', 'splice'].forEach(methodName => {
  arrProto[methodName] = function () {
    updateView()
    oldArrayProperty[methodName].call(this, ...arguments)
  }
})

function defineReactive(target, key, value) {
  observer(value)
  Object.defineProperty(target, key, {
    get() {
      return value
    },
    set(newValue) {
      if (newValue !== value) {
        observer(newValue) // è®¾ç½®æ–°å€¼æ—¶éœ€è¦é‡æ–°ç›‘å¬
        value = newValue
        // è§¦å‘æ›´æ–°è§†å›¾
        updateView()
      }
    }
  })
}

// ç›‘å¬å¯¹è±¡å±æ€§
function observer(target) {
  if (typeof target !== 'object' || target === null) {
    return target
  }
  if (Array.isArray(target)) {
    target.__proto__ = arrProto
  }
  for (let key in target) {
    defineReactive(target, key, target[key])
  }
}

const obj = {
  name: 'zhangsan',
  age: 20,
  info: {
    address: 'åŒ—äº¬' // éœ€è¦æ·±åº¦ç›‘å¬
  },
  nums: [10, 20, 30]
}

// ç›‘å¬æ•°æ®
observe(obj)

console.log(obj.foo) // è¾“å‡º 'get foo' å’Œ 'bar'
console.log(obj.baz.qux) // è¾“å‡º 'get baz' å’Œ 'get qux' å’Œ 'quux'
console.log(obj.arr[0]) // è¾“å‡º 'get arr' å’Œ '1'

obj.foo = 'baz' // è¾“å‡º 'set foo'
obj.baz.qux = 'corge' // è¾“å‡º 'set qux'
obj.arr[0] = 4 // è¾“å‡º 'set 0'

```

#### Vue3

Vue3 ä½¿ç”¨äº† ES6 çš„ Proxy æ¥ä»£æ›¿ Object.defineProperty å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒã€‚Proxy ä¸ Object.defineProperty ç›¸æ¯”æœ‰è®¸å¤šä¼˜åŠ¿ï¼Œä¾‹å¦‚å¯ä»¥å¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡ŒåŠ«æŒï¼Œæ”¯æŒå¯¹æ•°ç»„çš„åŠ«æŒç­‰ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºäº†åœ¨ Vue3 ä¸­å¦‚ä½•ä½¿ç”¨ Proxy å¯¹æ•°æ®è¿›è¡ŒåŠ«æŒï¼š

```js
const data = {
  count: 0
}

const proxyData = new Proxy(data, {
  get(target, key, receiver) {
    console.log(`getting ${key} value: ${target[key]}`);
    return Reflect.get(target, key, receiver);
  },
  set(target, key, value, receiver) {
    console.log(`setting ${key} value: ${value}`);
    return Reflect.set(target, key, value, receiver);
  }
});

proxyData.count = 1; // setting count value: 1
console.log(proxyData.count); // getting count value: 1
```

åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Proxy å¯¹è±¡æ¥ä»£ç† data å¯¹è±¡ã€‚å½“æˆ‘ä»¬ä¿®æ”¹ proxyData.count çš„å€¼æ—¶ï¼Œä¼šè§¦å‘ set() æ–¹æ³•ï¼Œè¾“å‡ºè®¾ç½®çš„å€¼ã€‚å½“æˆ‘ä»¬è®¿é—® proxyData.count çš„å€¼æ—¶ï¼Œä¼šè§¦å‘ get() æ–¹æ³•ï¼Œè¾“å‡ºè®¿é—®åˆ°çš„å€¼ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Vue3 ä¸­å®ç°å¯¹æ•°æ®çš„åŠ«æŒå’Œç›‘å¬ã€‚

### Vue 2.0 å“åº”å¼æ•°æ®çš„åŸç† ğŸˆ

1ã€Object.defineProperty æ•°æ®åŠ«æŒ 2ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ ä½¿ç”¨ getter æ”¶é›†ä¾èµ– ï¼Œsetter é€šçŸ¥ watcheræ´¾å‘æ›´æ–°

æ•´ä½“æ€è·¯æ˜¯æ•°æ®åŠ«æŒ + è§‚å¯Ÿè€…æ¨¡å¼

å¯¹è±¡å†…éƒ¨é€šè¿‡ defineReactive æ–¹æ³•ï¼Œä½¿ç”¨ Object.defineProperty å°†å±æ€§è¿›è¡ŒåŠ«æŒï¼ˆåªä¼šåŠ«æŒå·²å­˜åœ¨çš„å±æ€§ï¼‰ï¼Œæ•°ç»„åˆ™æ˜¯é€šè¿‡é‡å†™æ•°ç»„æ¥å®ç°ã€‚å½“é¡µé¢ä½¿ç”¨å¯¹åº”å±æ€§æ—¶ï¼Œæ¯ä¸ªå±æ€§éƒ½æ‹¥æœ‰è‡ªå·±çš„ dep å±æ€§ï¼Œå­˜åœ¨å®ƒæ‰€ä¾èµ–çš„ watcher ï¼ˆä¾èµ–æ”¶é›†ï¼‰getï¼Œå½“å±æ€§å˜åŒ–åä¼šé€šçŸ¥è‡ªå·±å¯¹åº”çš„ watcher å»æ›´æ–°ï¼ˆæ´¾å‘æ›´æ–°ï¼‰setã€‚

### è™šæ‹ŸDOM å’Œ diff

è™šæ‹Ÿ DOM æ˜¯ä¸€ç§è½»é‡çº§çš„ DOM æŠ½è±¡ï¼Œå®ƒå¯ä»¥åœ¨å†…å­˜ä¸­æ“ä½œå’Œè®¡ç®—ï¼Œå‡å°‘äº†çœŸå® DOM çš„æ“ä½œå’Œè®¡ç®—æ¬¡æ•°ï¼Œä»è€Œæé«˜äº†æ¸²æŸ“æ€§èƒ½ã€‚è™šæ‹Ÿ DOM æ˜¯ä»¥æ ‘å½¢ç»“æ„çš„æ–¹å¼ç»„ç»‡çš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ç€ä¸€ä¸ªçœŸå® DOM å…ƒç´ ï¼ŒåŒ…å«äº†å…ƒç´ çš„æ ‡ç­¾åã€å±æ€§ã€å­å…ƒç´ ç­‰ä¿¡æ¯ã€‚

Diff ç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯å…ˆå¯¹æ¯”æ ¹èŠ‚ç‚¹æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸åŒï¼Œåˆ™ç›´æ¥æ›¿æ¢ä¸ºæ–°çš„èŠ‚ç‚¹ï¼›å¦‚æœç›¸åŒï¼Œåˆ™æ¯”è¾ƒå­èŠ‚ç‚¹çš„å·®å¼‚ï¼Œå†æŒ‰ç…§ç›¸åº”çš„ç­–ç•¥è¿›è¡Œæ›´æ–°ã€‚ï¼ˆsnabbdomï¼‰

```js
// å®šä¹‰è™šæ‹Ÿ DOM èŠ‚ç‚¹çš„æ„é€ å‡½æ•°
function VNode(tag, props, children) {
  this.tag = tag
  this.props = props
  this.children = children
}

// å®šä¹‰ Diff ç®—æ³•çš„å®ç°å‡½æ•°
function diff(oldVNode, newVNode) {
  if (oldVNode === newVNode) {
    return
  }

  if (!oldVNode) {
    // å¦‚æœæ—§èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥æ–°èŠ‚ç‚¹
    render(newVNode)
  } else if (!newVNode) {
    // å¦‚æœæ–°èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥åˆ é™¤æ—§èŠ‚ç‚¹
    remove(oldVNode)
  } else if (oldVNode.tag !== newVNode.tag) {
    // å¦‚æœèŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œåˆ™ç›´æ¥æ›¿æ¢ä¸ºæ–°èŠ‚ç‚¹
    replace(oldVNode, newVNode)
  } else {
    // å¦åˆ™ï¼ŒæŒ‰ç…§ç›¸åº”çš„ç­–ç•¥æ›´æ–°å­èŠ‚ç‚¹
    update(oldVNode, newVNode)
  }
}

// å®šä¹‰æ¸²æŸ“èŠ‚ç‚¹çš„å‡½æ•°
function render(vnode) {
  const el = document.createElement(vnode.tag)
  Object.keys(vnode.props).forEach(key => {
    el.setAttribute(key, vnode.props[key])
  })
  vnode.children.forEach(child => {
    if (child instanceof VNode) {
      el.appendChild(render(child))
    } else {
      el.appendChild(document.createTextNode(child))
    }
  })
  return el
}

// å®šä¹‰æ›¿æ¢èŠ‚ç‚¹çš„å‡½æ•°
function replace(oldVNode, newVNode) {
  const parent = oldVNode.el.parentNode
  parent.replaceChild(render(newVNode), oldVNode.el)
}

// å®šä¹‰åˆ é™¤èŠ‚ç‚¹çš„å‡½æ•°
function remove(vnode) {
  const parent = vnode.el.parentNode
  parent.removeChild(vnode.el)
}

// å®šä¹‰æ›´æ–°èŠ‚ç‚¹çš„å‡½æ•°
function update(oldVNode, newVNode) {
  const el = oldVNode.el
  const oldChildren = oldVNode.children
  const newChildren = newVNode.children

  if (!newChildren.length) {
    // å¦‚æœæ–°èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥åˆ é™¤æ—§èŠ‚ç‚¹çš„å­èŠ‚ç‚¹
    el.innerHTML = ''
  } else {
    // å¦åˆ™ï¼ŒæŒ‰ç…§ç›¸åº”çš„ç­–ç•¥æ›´æ–°å­èŠ‚ç‚¹
    for (let i = 0; i < newChildren.length || i < oldChildren.length; i++) {
      diff(oldChildren[i], newChildren[i])
    }
  }
}

// å®šä¹‰è™šæ‹Ÿ DOM æ ‘
const oldVNode = new VNode('div', { id: 'app' }, [
  new VNode('p', {}, ['Hello,']),
  new VNode('p', {}, ['world!'])
])

const newVNode = new VNode('div', { id: 'app' }, [
  new VNode('p', {}, ['Hello,']),
  new VNode('p', {}, ['Vue!'])
])

// ä½¿ç”¨ Diff ç®—æ³•æ›´æ–°èŠ‚ç‚¹
diff(oldVNode, newVNode)
```

>Diff ç®—æ³•çš„å…·ä½“å®ç°æ–¹å¼æœ‰å¤šç§ï¼Œå¸¸è§çš„å®ç°æ–¹å¼åŒ…æ‹¬ï¼š
>
>1. å…¨é‡ Diffï¼šå¯¹æ¯”æ–°æ—§è™šæ‹Ÿ DOM æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ‰¾å‡ºå·®å¼‚ï¼Œå¹¶è¿›è¡Œæ›´æ–°ã€‚è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯æ•ˆç‡ä½ï¼Œå› ä¸ºéœ€è¦æ¯”è¾ƒæ‰€æœ‰èŠ‚ç‚¹ã€‚
>2. å±€éƒ¨ Diffï¼šåªå¯¹æ¯”æ–°æ—§è™šæ‹Ÿ DOM æ ‘ä¸­å‘ç”Ÿå˜åŒ–çš„èŠ‚ç‚¹ï¼Œæ‰¾å‡ºå·®å¼‚ï¼Œå¹¶è¿›è¡Œæ›´æ–°ã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œä½†éœ€è¦é¢å¤–çš„æ ‡è®°æˆ–äº‹ä»¶æ¥æ ‡è¯†å“ªäº›èŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–ã€‚
>3. åŒç«¯ Diffï¼šé€šè¿‡åŒæ—¶ä»æ–°æ—§è™šæ‹Ÿ DOM æ ‘çš„ä¸¤ç«¯å¼€å§‹éå†ï¼Œæ‰¾å‡ºå·®å¼‚ï¼Œå¹¶è¿›è¡Œæ›´æ–°ã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œä½†éœ€è¦å¯¹æ–°æ—§è™šæ‹Ÿ DOM æ ‘çš„ç»“æ„è¿›è¡Œé¢å¤–çš„åˆ¤æ–­å’Œå¤„ç†ã€‚
>
>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¸¸å¸¸é‡‡ç”¨å±€éƒ¨ Diff çš„æ–¹å¼æ¥å®ç°è™šæ‹Ÿ DOM çš„æ›´æ–°ï¼Œé…åˆä½¿ç”¨ä¸€äº›ä¼˜åŒ–æŠ€å·§ï¼Œå¯ä»¥æé«˜è™šæ‹Ÿ DOM çš„æ€§èƒ½å’Œæ¸²æŸ“é€Ÿåº¦ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ key å±æ€§æ¥æ ‡è¯†èŠ‚ç‚¹ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„ DOM æ“ä½œï¼›å¯ä»¥ä½¿ç”¨æ‰¹é‡æ›´æ–°çš„æ–¹å¼ï¼Œå°†å¤šæ¬¡æ“ä½œåˆå¹¶ä¸ºä¸€æ¬¡æ“ä½œï¼Œä»è€Œå‡å°‘æ›´æ–°çš„æ¬¡æ•°ï¼›å¯ä»¥ä½¿ç”¨å¼‚æ­¥æ›´æ–°çš„æ–¹å¼ï¼Œå°†æ›´æ–°æ“ä½œæ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰§è¡Œï¼Œä»è€Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚

- 1ã€tag æ ‡ç­¾ä¸ä¸€è‡´ç›´æ¥æ–°èŠ‚ç‚¹æ›¿æ¢æ—§èŠ‚ç‚¹ã€‚
- 2ã€tag æ ‡ç­¾ä¸€æ ·ã€‚
- - å…ˆæ›¿æ¢å±æ€§
- - å¯¹æ¯”å­å…ƒç´ 
- - - æ–°è€éƒ½æœ‰å­å…ƒç´ ï¼Œé‡‡ç”¨åŒæŒ‡é’ˆæ–¹å¼è¿›è¡Œå¯¹æ¯” sameVnode åˆ¤æ–­tagå’Œkeyå®Œå…¨ç›¸åŒä¸ºåŒä¸€èŠ‚ç‚¹ï¼Œè¿›è¡ŒèŠ‚ç‚¹å¤ç”¨
- - - - å¤´å’Œå¤´ç›¸ç­‰å¯¹æ¯”
- - - - å°¾å’Œå°¾ç›¸ç­‰å¯¹æ¯”
- - - - å¤´å’Œå°¾ç›¸ç­‰å¯¹æ¯”
- - - - - sameVnode çš„æ—¶å€™ä¼ å…¥ä¸¤ä¸ªæ–°è€å­èŠ‚ç‚¹patch(oldChild,newChild)
- - - - ä¹±åºæƒ…å†µ
- - - - - ä¸Šé¢çš„éƒ½ä¸ç¬¦åˆï¼Œå…ˆéå†æ—§å­èŠ‚ç‚¹æ•°ç»„å½¢æˆ keyå€¼æ˜ å°„çš„mapå¯¹è±¡ã€‚ ç„¶åæ ¹æ®æ–°å­èŠ‚ç‚¹æ•°ç»„å¾ªç¯ æŒ‰ç…§keyå€¼å’Œä½ç½®å…³ç³»ç§»åŠ¨ä»¥åŠæ–°å¢èŠ‚ç‚¹ æœ€ååˆ é™¤å¤šä½™çš„æ—§å­èŠ‚ç‚¹ å¦‚æœç§»åŠ¨æ—§èŠ‚ç‚¹åŒæ ·éœ€è¦patch(oldChild,newChild)
- - - æ–°çš„æœ‰å­å…ƒç´ ï¼Œè€çš„æ²¡æœ‰å­å…ƒç´ ã€‚-- ç›´æ¥å°†å­å…ƒç´ è™šæ‹ŸèŠ‚ç‚¹è½¬åŒ–æˆçœŸå®èŠ‚ç‚¹æ’å…¥å³å¯ã€‚
- - - æ–°çš„æ²¡æœ‰å­å…ƒç´ ï¼Œè€çš„æœ‰å­å…ƒç´ ã€‚ -- ç›´æ¥æ¸…ç©º innerHtml
- 3ã€æ—  tag æ ‡ç­¾ -- æ–‡æœ¬èŠ‚ç‚¹ç›´æ¥æ¯”è¾ƒå†…å®¹æ˜¯å¦ä¸€è‡´

### æ¨¡ç‰ˆç¼–è¯‘

å°†æ¨¡ç‰ˆç¼–è¯‘æˆrenderå‡½æ•°ï¼Œæ‰§è¡Œrenderå‡½æ•°ç”Ÿæˆvnode

Vue çš„ç¼–è¯‘è¿‡ç¨‹å°±æ˜¯å°† template è½¬åŒ–ä¸º render å‡½æ•°çš„è¿‡ç¨‹ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š

ç¬¬ä¸€æ­¥æ˜¯å°† æ¨¡æ¿å­—ç¬¦ä¸²è½¬æ¢æˆ element ASTsï¼ˆè§£æå™¨ï¼‰

ç¬¬äºŒæ­¥æ˜¯å¯¹ AST è¿›è¡Œé™æ€èŠ‚ç‚¹æ ‡è®°ï¼Œä¸»è¦ç”¨æ¥åšè™šæ‹Ÿ DOM çš„æ¸²æŸ“ä¼˜åŒ–ï¼ˆä¼˜åŒ–å™¨ï¼‰

ç¬¬ä¸‰æ­¥æ˜¯ ä½¿ç”¨element ASTs ç”Ÿæˆ render å‡½æ•°ä»£ç å­—ç¬¦ä¸²ï¼ˆä»£ç ç”Ÿæˆå™¨ï¼‰

### è·¯ç”±åŸç†

- hash

  - å˜åŒ–ä¸ä¼šåˆ·æ–°é¡µé¢
  - ä¼šè§¦å‘ç½‘é¡µè·³è½¬ï¼Œå³å‰è¿›å’Œåé€€
  - å’Œserverç«¯æ— äº¤äº’

  ```js
  // å®šä¹‰è·¯ç”±æ˜ å°„è¡¨
  const routes = {
    '/': home,
    '/about': about,
    '/contact': contact
  }
  
  // å®šä¹‰è·¯ç”±å¤„ç†å‡½æ•°
  function router() {
    const hash = location.hash.slice(1) || '/'
    const component = routes[hash] || notFound
    component.render()
  }
  
  // ç›‘å¬ hash å€¼å˜åŒ–äº‹ä»¶
  window.addEventListener('hashchange', router)
  
  // åˆå§‹åŒ–è·¯ç”±
  router()
  ```

- H5 history

  - ç”¨url è§„èŒƒçš„è·¯ç”±ï¼Œè·³è½¬æ—¶ä¸åˆ·æ–°é¡µé¢
  - history.pushState window.onpopstate
  - éœ€è¦æœåŠ¡ç«¯æ”¯æŒ

- MemoryHistory(vue)

  - ä¸ä¼šå‰è¿›å’Œåé€€

### Vue è·¯ç”±å®ˆå«çš„åŸç†

1. å…¨å±€é’©å­å‡½æ•°ï¼šVue Router æä¾›äº†ä¸€äº›å…¨å±€çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼ŒåŒ…æ‹¬ `beforeEach`ã€`beforeResolve` å’Œ `afterEach`ã€‚è¿™äº›é’©å­å‡½æ•°ä¼šåœ¨è·¯ç”±è·³è½¬æ—¶ä¾æ¬¡æ‰§è¡Œï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œè·¯ç”±å®ˆå«æ“ä½œã€æ•°æ®é¢„å–ç­‰ã€‚

- `beforeEach(to, from, next)`ï¼šåœ¨è·¯ç”±è·³è½¬å‰æ‰§è¡Œï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œè·¯ç”±å®ˆå«æ“ä½œã€‚å¦‚æœéœ€è¦è·³è½¬åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±ï¼Œéœ€è¦è°ƒç”¨ `next()` å‡½æ•°ã€‚
- `beforeResolve(to, from, next)`ï¼šåœ¨è·¯ç”±è·³è½¬å‰æ‰§è¡Œï¼Œç”¨æ¥å¤„ç†å¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚å¦‚æœéœ€è¦è·³è½¬åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±ï¼Œéœ€è¦è°ƒç”¨ `next()` å‡½æ•°ã€‚
- `afterEach(to, from)`ï¼šåœ¨è·¯ç”±è·³è½¬åæ‰§è¡Œï¼Œç”¨æ¥è¿›è¡Œä¸€äº›æ”¶å°¾å·¥ä½œï¼Œä¾‹å¦‚æ¸…é™¤ä¸´æ—¶æ•°æ®ã€‚

2. ç»„ä»¶å†…çš„é’©å­å‡½æ•°ï¼šåœ¨ Vue Router ä¸­ï¼Œç»„ä»¶ä¹Ÿå¯ä»¥å®šä¹‰ä¸€äº›ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°æ¥å¤„ç†è·¯ç”±ç›¸å…³çš„é€»è¾‘ã€‚è¿™äº›é’©å­å‡½æ•°åŒ…æ‹¬ `beforeRouteEnter`ã€`beforeRouteUpdate` å’Œ `beforeRouteLeave`ã€‚

- `beforeRouteEnter(to, from, next)`ï¼šåœ¨ç»„ä»¶å®ä¾‹åŒ–ä¹‹å‰è°ƒç”¨ï¼Œç”¨äºåœ¨ç»„ä»¶å†…éƒ¨å¤„ç†è·¯ç”±ç›¸å…³é€»è¾‘ã€‚å¦‚æœéœ€è¦è·³è½¬åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±ï¼Œéœ€è¦è°ƒç”¨ `next()` å‡½æ•°ã€‚
- `beforeRouteUpdate(to, from, next)`ï¼šåœ¨ç»„ä»¶å¯ä»¥å¤ç”¨æ—¶è°ƒç”¨ï¼Œç”¨äºæ›´æ–°ç»„ä»¶å†…çš„æ•°æ®ã€‚å¦‚æœéœ€è¦è·³è½¬åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±ï¼Œéœ€è¦è°ƒç”¨ `next()` å‡½æ•°ã€‚
- `beforeRouteLeave(to, from, next)`ï¼šåœ¨ç»„ä»¶é€€å‡ºå‰è°ƒç”¨ï¼Œç”¨äºç¡®è®¤æ˜¯å¦å¯ä»¥ç¦»å¼€è¯¥è·¯ç”±ã€‚å¦‚æœéœ€è¦è·³è½¬åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±ï¼Œéœ€è¦è°ƒç”¨ `next()` å‡½æ•°ã€‚

åœ¨ Vue.js åº”ç”¨ç¨‹åºä¸­ï¼ŒVue Router æ˜¯ä½œä¸ºä¸€ä¸ªæ’ä»¶æ¥ä½¿ç”¨çš„ï¼Œå®ƒä¼šåœ¨ Vue å®ä¾‹åŒ–ä¹‹å‰è¿›è¡Œå®‰è£…

æˆ‘ä»¬é€šè¿‡åˆ›å»ºä¸€ä¸ª Vue å®ä¾‹æ¥å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨ `Vue.use()` æ–¹æ³•æ¥å®‰è£… Vue Router æ’ä»¶

åœ¨è·¯ç”±è§£æè¿‡ç¨‹ä¸­ï¼ŒVue Router ä¼šæŒ‰ç…§è·¯ç”±é…ç½®ä¸­çš„é¡ºåºä¾æ¬¡æ‰§è¡Œå…¨å±€å‰ç½®å®ˆå« `beforeEach`ã€è·¯ç”±ç‹¬äº«å®ˆå« `beforeEnter` å’Œç»„ä»¶å†…å®ˆå« `beforeRouteEnter`ï¼Œå¹¶æ ¹æ®å®ˆå«çš„è¿”å›å€¼å†³å®šæ˜¯å¦å…è®¸è·¯ç”±è·³è½¬ã€‚å¦‚æœæŸä¸ªå®ˆå«è¿”å›äº† `false` æˆ–è€…è°ƒç”¨äº† `next(false)`ï¼Œåˆ™è¯¥è·¯ç”±è·³è½¬ä¼šè¢«ä¸­æ­¢ï¼Œä¸ä¼šè¿›å…¥è¯¥è·¯ç”±ã€‚

### Vue watch å’Œ computed çš„åŒºåˆ«

- `watch` é€‚ç”¨äºç›‘å¬æŸä¸ªæ•°æ®çš„å˜åŒ–ï¼Œå¹¶åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œä¸€äº›å¼‚æ­¥æˆ–å¤æ‚çš„æ“ä½œï¼Œä¾‹å¦‚å‘é€ç½‘ç»œè¯·æ±‚ã€æ›´æ–° DOM ç­‰ã€‚`watch` å¯ä»¥ç›‘å¬å“åº”å¼æ•°æ®çš„å˜åŒ–ï¼Œä¹Ÿå¯ä»¥ç›‘å¬éå“åº”å¼æ•°æ®çš„å˜åŒ–ã€‚
- `computed` é€‚ç”¨äºæ ¹æ®æŸä¸ªæˆ–æŸäº›å“åº”å¼æ•°æ®çš„å˜åŒ–ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ–°çš„å€¼ï¼Œå¹¶å°†è¯¥å€¼ä½œä¸ºä¸€ä¸ªæ–°çš„å“åº”å¼æ•°æ®æš´éœ²å‡ºå»ã€‚`computed` çš„è®¡ç®—ç»“æœä¼šè¢«ç¼“å­˜ï¼Œåªæœ‰å½“è®¡ç®—ä¾èµ–çš„å“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°è®¡ç®—ã€‚

ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `watch` å’Œ `computed` è®¡ç®—ä¸€ä¸ªå±æ€§ `fullName`ï¼š

```js
var vm = new Vue({
  data: {
    firstName: 'John',
    lastName: 'Doe'
  },
  computed: {
    fullName: function () {
      return this.firstName + ' ' + this.lastName
    }
  },
  watch: {
    firstName: function () {
      this.fullName = this.firstName + ' ' + this.lastName
    },
    lastName: function () {
      this.fullName = this.firstName + ' ' + this.lastName
    }
  }
})
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œ`computed` å±æ€§å®šä¹‰äº†ä¸€ä¸ªè®¡ç®—å±æ€§ `fullName`ï¼Œè¯¥å±æ€§æ ¹æ® `firstName` å’Œ `lastName` è®¡ç®—å‡ºä¸€ä¸ªæ–°çš„å€¼ï¼Œå¹¶å°†è¯¥å€¼ä½œä¸ºä¸€ä¸ªæ–°çš„å“åº”å¼æ•°æ®æš´éœ²å‡ºå»ã€‚`watch` å±æ€§ç”¨äºç›‘å¬ `firstName` å’Œ `lastName` çš„å˜åŒ–ï¼Œå½“è¿™ä¸¤ä¸ªæ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°†é‡æ–°è®¡ç®— `fullName` å¹¶æ›´æ–°è¯¥å±æ€§çš„å€¼ã€‚

ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `watch` å’Œ `computed` è®¡ç®—å•†å“åˆ—è¡¨çš„æ€»ä»·ï¼š

```js
var vm = new Vue({
  data: {
    products: [
      { name: 'Product A', price: 10, quantity: 2 },
      { name: 'Product B', price: 20, quantity: 3 },
      { name: 'Product C', price: 30, quantity: 4 }
    ]
  },
  computed: {
    total: function () {
      return this.products.reduce(function (total, product) {
        return total + product.totalPrice
      }, 0)
    }
  },
  watch: {
    products: {
      deep: true,
      handler: function (newValue, oldValue) {
        newValue.forEach(function (product) {
          this.$set(product, 'totalPrice', product.price * product.quantity)
        }, this)
      }
    }
  }
})
```

ä¸Šè¿°ä»£ç ä¸­ï¼Œ`products` æ˜¯ä¸€ä¸ªå“åº”å¼æ•°æ®ï¼ŒåŒ…å«äº†ä¸‰ä¸ªå•†å“çš„ä¿¡æ¯ã€‚`computed` å±æ€§ä¸­å®šä¹‰äº†ä¸€ä¸ªè®¡ç®—å±æ€§ `total`ï¼Œè¯¥å±æ€§è®¡ç®—å‡ºæ‰€æœ‰å•†å“çš„æ€»ä»·ã€‚`watch` å±æ€§ç›‘å¬ `products` æ•°æ®çš„å˜åŒ–ï¼Œå½“ `products` æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°è®¡ç®—æ¯ä¸ªå•†å“çš„æ€»ä»·ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªæ–°çš„å“åº”å¼æ•°æ® `totalPrice` æ·»åŠ åˆ°å•†å“å¯¹è±¡ä¸­ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨ `watch` å’Œ `computed` æ—¶ï¼Œéœ€è¦æ³¨æ„å®ƒä»¬çš„æ‰§è¡Œé¡ºåºå’Œä¾èµ–å…³ç³»ï¼Œä»¥é¿å…å‡ºç°æ„å¤–çš„ç»“æœã€‚åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ`watch` éœ€è¦åœ¨ `computed` ä¹‹å‰æ‰§è¡Œï¼Œä»¥ç¡®ä¿è®¡ç®—å±æ€§ `total` èƒ½å¤Ÿæ­£ç¡®åœ°ä¾èµ–å•†å“çš„æ€»ä»·ã€‚

### Vueçš„è®¡ç®—å±æ€§å¦‚ä½•å®ç°ç¼“å­˜

è®¡ç®—å±æ€§çš„ç¼“å­˜æ˜¯é€šè¿‡ `Object.defineProperty` æ–¹æ³•çš„ getter å’Œ setter å®ç°çš„ï¼ŒVue.js åœ¨è®¡ç®—å±æ€§çš„ getter å‡½æ•°ä¸­ï¼Œä¼šä½¿ç”¨ä¸€ä¸ªåä¸º `Dep` çš„ç±»æ¥è¿›è¡Œä¾èµ–æ”¶é›†ã€‚å½“è®¡ç®—å±æ€§çš„ getter å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼ŒVue.js ä¼šå°†å½“å‰çš„è®¡ç®—å±æ€§ä½œä¸ºä¾èµ–å¯¹è±¡ï¼Œå°†å…¶æ·»åŠ åˆ°ä¸€ä¸ªå…¨å±€çš„ä¾èµ–æ”¶é›†å™¨ä¸­ã€‚å¦‚æœåœ¨è®¡ç®—å±æ€§çš„ getter å‡½æ•°ä¸­è®¿é—®äº†å…¶ä»–å“åº”å¼å±æ€§ï¼ˆå¦‚ `data` æˆ–å…¶ä»–è®¡ç®—å±æ€§ï¼‰ï¼ŒVue.js ä¼šå°†è¿™äº›å±æ€§çš„ä¾èµ–ä¹Ÿæ·»åŠ åˆ°å…¨å±€çš„ä¾èµ–æ”¶é›†å™¨ä¸­ã€‚å½“è¿™äº›å“åº”å¼å±æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒVue.js ä¼šé‡æ–°è®¡ç®—è®¡ç®—å±æ€§çš„å€¼ï¼Œå¹¶å°†è®¡ç®—ç»“æœç¼“å­˜èµ·æ¥ã€‚

### v-model åŸç†

`v-model` ä¼šç›‘å¬è¡¨å•å…ƒç´ çš„ `input` æˆ– `change` äº‹ä»¶ï¼Œå¹¶åœ¨äº‹ä»¶è§¦å‘æ—¶æ›´æ–°ç»‘å®šçš„å±æ€§ï¼Œç›¸å½“äºæ˜¯è¯­æ³•ç³–

### v-forä¸ºä»€ä¹ˆè¦åŠ key

`keyæ˜¯Vueä¸­Vnodeçš„æ ‡è¯†`ï¼Œé€šè¿‡è¿™ä¸ªkeyï¼Œæˆ‘ä»¬çš„diffæ“ä½œå¯ä»¥æ›´å‡†ç¡®ã€æ›´å¿«é€Ÿã€‚å¦‚æœä¸ä½¿ç”¨keyï¼ŒVueä¼šä½¿ç”¨ä¸€ç§æœ€å¤§é™åº¦å‡å°‘åŠ¨æ€å…ƒç´ å¹¶ä¸”å°½å¯èƒ½çš„å°è¯•å°±åœ°ä¿®æ”¹/å¤ç”¨ç›¸åŒç±»å‹å…ƒç´ çš„ç®—æ³•ã€‚

### vue-router ç»„ä»¶å¤ç”¨å¯¼è‡´è·¯ç”±å‚æ•°å¤±æ•ˆæ€ä¹ˆåŠ

1ã€é€šè¿‡watchç›‘å¬è·¯ç”±å‚æ•°å†å‘è¯·æ±‚

```javascript
watch: {
  "router": function () {
    this.getData(this.$router.params.xxx)
  }
}
```

2ã€ç”¨ :keyæ¥é˜»æ­¢å¤ç”¨

```text
router-view :key="$route.fullPath"
```

### Vue ä¿®é¥°ç¬¦æœ‰å“ªäº›ï¼Ÿ

```text
äº‹ä»¶ä¿®é¥°ç¬¦
.stop é˜»æ­¢äº‹ä»¶ç»§ç»­ä¼ æ’­
.prevent é˜»æ­¢æ ‡ç­¾é»˜è®¤è¡Œä¸º
.capture ä½¿ç”¨äº‹ä»¶æ•è·æ¨¡å¼ï¼Œå³å…ƒç´ è‡ªèº«è§¦å‘çš„äº‹ä»¶å…ˆåœ¨æ­¤å¤„å¤„ç†ï¼Œç„¶åæ‰äº¤ç”±å†…éƒ¨å…ƒç´ è¿›è¡Œå¤„ç†
.self åªå½“åœ¨ event.target æ˜¯å½“å‰å…ƒç´ è‡ªèº«æ—¶è§¦å‘å¤„ç†å‡½æ•°
.once äº‹ä»¶åªä¼šè§¦å‘ä¸€æ¬¡
.passive å‘Šè¯‰æµè§ˆå™¨ä½ ä¸æƒ³é˜»æ­¢äº‹ä»¶çš„é»˜è®¤è¡Œä¸º
v-model çš„ä¿®é¥°ç¬¦
.lazy é€šè¿‡è¿™ä¸ªä¿®é¥°ç¬¦ï¼Œè½¬å˜ä¸ºåœ¨ change äº‹ä»¶å†åŒæ­¥
.number è‡ªåŠ¨å°†ç”¨æˆ·è¾“å…¥å€¼è½¬åŒ–ä¸ºæ•°å€¼ç±»å‹
.trim è‡ªåŠ¨è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„æ”¶å°¾ç©ºæ ¼
é”®ç›˜äº‹ä»¶ä¿®é¥°ç¬¦
.enter
.tab
.delete (æ•è·â€œåˆ é™¤â€å’Œâ€œé€€æ ¼â€é”®)
.esc
.space
.up
.down
.left
.right
ç³»ç»Ÿä¿®é¥°ç¬¦
.ctrl
.alt
.shift
.meta
é¼ æ ‡æŒ‰é’®ä¿®é¥°ç¬¦
.left
.right
.middle
```

### nextTick ä½¿ç”¨åœºæ™¯å’ŒåŸç†

nextTick ä¸­çš„å›è°ƒæ˜¯åœ¨ä¸‹æ¬¡ DOM æ›´æ–°å¾ªç¯ç»“æŸä¹‹åæ‰§è¡Œçš„å»¶è¿Ÿå›è°ƒã€‚åœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè·å–æ›´æ–°åçš„ DOMã€‚ä¸»è¦æ€è·¯å°±æ˜¯é‡‡ç”¨å¾®ä»»åŠ¡ä¼˜å…ˆçš„æ–¹å¼è°ƒç”¨å¼‚æ­¥æ–¹æ³•å»æ‰§è¡Œ nextTick åŒ…è£…çš„æ–¹æ³•ã€‚

### Vue å’Œ React çš„åŒºåˆ«ğŸˆ

- ç›‘å¬æ•°æ®ä¸Šï¼šVue é€šè¿‡ getter / setter ä»¥åŠä¸€äº›å‡½æ•°çš„åŠ«æŒï¼Œèƒ½ç²¾ç¡®ç›´åˆ°æ•°æ®å˜åŒ–
  React é»˜è®¤æ˜¯é€šè¿‡æ¯”è¾ƒå¼•ç”¨çš„æ–¹å¼ï¼ˆ diff ï¼‰è¿›è¡Œçš„ï¼Œå¦‚æœä¸ä¼˜åŒ–å¯èƒ½å¯¼è‡´å¤§é‡ä¸å¿…è¦è®¡ç®—çš„ VDOM çš„é‡æ–°æ¸²æŸ“ã€‚
- è®¾è®¡ç†å¿µï¼švue ä½¿ç”¨çš„æ˜¯å¯å˜æ•°æ®ï¼Œè€Œ React æ›´å¼ºè°ƒæ•°æ®ä¸å¯å˜
- æ•°æ®æµï¼šVue æ˜¯åŒå‘ç»‘å®šæ•°æ®æµï¼Œè€Œ React æ˜¯å•å‘æ•°æ®æµ
- æ¨¡ç‰ˆæ¸²æŸ“æ–¹å¼: React æ˜¯é€šè¿‡JSXæ¸²æŸ“æ¨¡æ¿ï¼Œè€ŒVueæ˜¯é€šè¿‡ä¸€ç§æ‹“å±•çš„HTMLè¯­æ³•è¿›è¡Œæ¸²æŸ“
- æ¸²æŸ“è¿‡ç¨‹ï¼šVue æ˜¯è¾¹è®¡ç®—è¾¹æ¸²æŸ“ï¼Œè€Œ React æ˜¯ç­‰è®¡ç®—å®Œæ¯•ä¹‹ååœ¨æ¸²æŸ“
- æ•°æ®ç»‘å®šï¼šVue æä¾›äº†åŒå‘æ•°æ®ç»‘å®šå’Œè®¡ç®—å±æ€§ç­‰åŠŸèƒ½ï¼Œè€Œ React åªæä¾›å•å‘æ•°æ®æµå’Œä¸å¯å˜æ•°æ®ç»“æ„ã€‚Vue çš„åŒå‘æ•°æ®ç»‘å®šå¯ä»¥è®©å¼€å‘è€…æ›´æ–¹ä¾¿åœ°æ“ä½œè§†å›¾å’Œæ•°æ®ä¹‹é—´çš„å…³ç³»ï¼Œè€Œ React çš„å•å‘æ•°æ®æµå¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ•°æ®çš„æµåŠ¨å’Œå˜åŒ–ï¼Œé¿å…äº†ä¸€äº›æ½œåœ¨çš„é—®é¢˜ã€‚

- å“åº”å¼ç³»ç»Ÿï¼šVue çš„å“åº”å¼ç³»ç»Ÿä½¿ç”¨äº† Object.defineProperty å’Œ Proxy ç­‰æŠ€æœ¯ï¼Œå¯ä»¥è‡ªåŠ¨è¿½è¸ªæ•°æ®çš„å˜åŒ–å¹¶æ›´æ–°è§†å›¾ï¼Œè€Œ React åˆ©ç”¨è™šæ‹Ÿ DOM å’Œ diff ç®—æ³•æ¥ä¼˜åŒ–è§†å›¾çš„æ¸²æŸ“æ€§èƒ½ã€‚Vue çš„å“åº”å¼ç³»ç»Ÿå¯¹äºå°å‹åº”ç”¨å’Œæ•°æ®é‡è¾ƒå°çš„åº”ç”¨éå¸¸å‹å¥½ï¼Œè€Œ React åœ¨å¤§å‹åº”ç”¨å’Œæ•°æ®é‡è¾ƒå¤§çš„åº”ç”¨ä¸­è¡¨ç°æ›´åŠ å‡ºè‰²ã€‚

- ç»„ä»¶åŒ–ï¼šVue å’Œ React éƒ½æ”¯æŒç»„ä»¶åŒ–å¼€å‘ï¼Œä½†æ˜¯å®ƒä»¬çš„å®ç°æ–¹å¼ç•¥æœ‰ä¸åŒã€‚Vue çš„ç»„ä»¶åŒ…æ‹¬æ¨¡æ¿ã€æ ·å¼å’Œé€»è¾‘ï¼Œå¯ä»¥ç›´æ¥ç¼–å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œ React çš„ç»„ä»¶å°†æ¨¡æ¿ã€æ ·å¼å’Œé€»è¾‘åˆ†ç¦»å¼€æ¥ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨ JSX æˆ–è€…æ¨¡æ¿å­—ç¬¦ä¸²æ¥æè¿°ç»„ä»¶çš„ç»“æ„å’Œæ ·å¼ã€‚

- ç”Ÿå‘½å‘¨æœŸï¼šVue å’Œ React éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œä½†æ˜¯å®ƒä»¬çš„åç§°å’Œè§¦å‘æ—¶æœºç•¥æœ‰ä¸åŒã€‚Vue çš„ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ beforeCreateã€createdã€beforeMountã€mountedã€beforeUpdateã€updatedã€beforeDestroy å’Œ destroyed ç­‰é’©å­å‡½æ•°ï¼Œè€Œ React çš„ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ constructorã€getDerivedStateFromPropsã€componentDidMountã€shouldComponentUpdateã€getSnapshotBeforeUpdateã€componentDidUpdate å’Œ componentWillUnmount ç­‰é’©å­å‡½æ•°ã€‚

### Reactä¸ Vueæ›´æ–°æ•°æ®çš„åŒºåˆ«

- Vue åªæœ‰ä¾èµ–æ”¶é›†çš„æ•°æ®å‘ç”Ÿæ›´æ–°ï¼Œæ‰ä¼šå»é‡æ–°æ¸²æŸ“é¡µé¢

- åªè¦æ•°æ®æœ‰æ›´æ–°ï¼ˆsetStateï¼ŒuseState ç­‰æ‰‹æ®µè§¦å‘æ›´æ–°ï¼‰ï¼Œéƒ½ä¼šå»é‡æ–°æ¸²æŸ“é¡µé¢
  ï¼ˆå¯ä»¥ä½¿ç”¨shouldComponentUpdate/ PureComponent æ”¹å–„ï¼‰

>`Vue` é€šè¿‡**ä¾èµ–æ”¶é›†**ï¼Œå½“æ•°æ®æ›´æ–°æ—¶ï¼Œ `Vue` æ˜ç¡®çŸ¥é“æ˜¯å“ªäº›æ•°æ®æ›´æ–°äº†ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„æ¸²æŸ“ `watcher` ï¼ŒæŒç®¡å½“å‰ç»„ä»¶çš„è§†å›¾æ›´æ–°ï¼Œæ‰€ä»¥å¯ä»¥ç²¾ç¡®åœ°æ›´æ–°å¯¹åº”çš„ç»„ä»¶ï¼Œæ‰€ä»¥æ›´æ–°çš„ç²’åº¦æ˜¯**ç»„ä»¶çº§åˆ«**çš„ã€‚
>
>React ä¼šé€’å½’åœ°æŠŠæ‰€æœ‰çš„å­ç»„ä»¶ é‡æ–° `render` ä¸€ä¸‹ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯æ›´æ–°çš„æ•°æ®ï¼Œæ­¤æ—¶ï¼Œéƒ½æ˜¯æ–°çš„ã€‚ç„¶åé€šè¿‡ diff ç®—æ³• æ¥å†³å®šæ›´æ–°å“ªéƒ¨åˆ†çš„è§†å›¾ã€‚æ‰€ä»¥ï¼ŒReact çš„æ›´æ–°ç²’åº¦æ˜¯ä¸€ä¸ªæ•´ä½“ã€‚

### Vue2 Vue3 å’Œ React ä¸‰è€…diffç®—æ³•çš„åŒºåˆ«

- Vue2 åŒç«¯æ¯”è¾ƒ
- Vue3 æœ€é•¿é€’å¢å­åºåˆ—
- React ä»…å³ç§»
